*
  box-sizing: border-box
  margin: 0
  padding: 0

@import 'typography.styl'
@import 'colors.styl'

butt-on()
  border: 1px solid color-light-button-border
  outline: none
  border-radius: 2px
  background-color: color-light-button-bg
butt-on-states()
  &:hover
    background-color: color-light-button-bg-pending
    cursor: pointer

  &:active
    background-color: color-light-button-bg-active

  &[disabled]
    background-color: color-light-button-bg-disabled

[aria-hidden]
  display: none

body
  background-color: color-light-bg
  color: color-light-fg
  width: 100%
  height: 100%

  &.dark
    background-color: color-dark-bg
    color: color-dark-text

h1, h6
  color: color-light-fg-lesser

a, a:visited, a:hover, a:focus, a:active
  color: color-light-accent

header
  background-color: color-light-accent
  color: color-light-title
  display: flex
  height: 48px
  z-index: 10

  position: fixed !important
  left: 0px
  right: 0px
  top: 0

  > p
    flex: 1
    font-size: 20px
    font-weight: 500
    letter-spacing: 0.005em
    text-rendering: optimizeLegibility
    margin: auto 1em

  .actions
    display: flex

.icon-invert.icon-invert
  color: color-light-icon-invert
  &:disabled
    color: color-light-icon-invert-disabled

.icon-normal.icon-normal
  color: color-light-icon

#active-users
  font-size: 16px
  margin: auto
  min-width: 48px
  text-align: center

.dropdown
  width: 48px
  height: 48px
  margin: 0
  overflow: visible
  position: relative

  .toggle
    padding: 12px
    background-color: color-transparent
    border: none
    outline: none

    :hover
      background-color: color-light-menu-pending
      cursor: pointer

  .menu
    border-radius: 2px
    min-width: 168px
    outline: none
    margin-top: 8px
    margin-right: 8px
    position: absolute
    right: 0px
    top: 0px
    opacity: 0
    visibility: hidden

    transform: scale(0)
    transform-origin: 100% 0%

    transition: visibility 0.3s, opacity 0.3s, transform 0.3s
    transition-timing-function: cubic-bezier(.4, 0, .2, 1)

    ^[-1].active ^[-1..-1]
      opacity: 1
      visibility: visible

      transform: scale(1)

  button
    width: 100%
    height: 48px
    outline: none
    border: none
    background-color: color-light-bg
    color: color-light-fg
    font-size: 16px
    padding-left: 16px
    padding-right: 16px
    text-align: left

    &.material-icons
      font-size: 24px

    &:first-child
      border-top-left-radius: 2px
      border-top-right-radius: 2px

    &:last-child
      border-bottom-left-radius: 2px
      border-bottom-right-radius: 2px

    &:hover
      background-color: color-light-bg-pending
      cursor: pointer

    &:active
      background-color: color-light-bg-active


  .toggle.message-overflow
    padding: 0

    &:hover, &:active
      background-color: transparent


main
  height: 100%

  margin: 56px auto 0
  padding: 0
  min-width: 640px
  max-width: 1400px

  &.room
    margin: 56px auto 158px
    display: flex

#broadcast-pane
  width: 50%

  .video-container
    width: 100%
    padding-bottom: 75%
    margin-bottom: -1px
    position: relative
    overflow: hidden
    flex-shrink: 0

#message-pane
  width: 50%

#message-list
  border-radius: 2px
  list-style-type: none

  li
    background-color: color-light-message-bg
    border-bottom: 1px solid color-light-message-separator
    display: flex
    font-size: 20px
    padding: 0px

    &:first-child
      border-top-left-radius: 2px
      border-top-right-radius: 2px

    &:last-child
      border-bottom-left-radius: 2px
      border-bottom-right-radius: 2px
      overflow: hidden
      border-bottom: none

    .video-container
      width: 200px
      height: 150px
      margin-bottom: -1px
      position: relative
      overflow: hidden
      flex-shrink: 0

      ^[-1]:first-child ^[-1..-1]
        border-top-left-radius: 2px
        overflow: hidden

      ^[-1]:last-child ^[-1..-1]
        border-bottom-left-radius: 2px
        overflow: hidden
        margin-bottom: 0

    p
      flex: 1 1
      padding: 8px

      word-wrap: break-word
      overflow-wrap: break-word
      overflow: hidden

    .message-meta
      flex-shrink: 0
      display: flex
      flex-direction: column
      align-items: flex-end
      justify-content: space-between
      padding: 0 0 4px

.video-container
  .filmstrip
    display: none
    width: 100%
    height: 1000%
    position: absolute
    top: 0
    left: 0
    backface-visibility: hidden

  .displayed & .filmstrip
    display: block
    animation: filmstrip 0.92s infinite
    transform: translateZ(0)

    .backgrounded &
      display: none
      animation: none

  .save, .save:focus
    position: absolute
    display: block
    padding: 4px 8px
    bottom: 8px
    left: 8px

    butt-on()
    opacity: 0
    visibility: hidden

    transition: visibility 0.4s, opacity 0.4s, background-color 0.4s
    transition-timing-function: cubic-bezier(.4, 0, .2, 1)

  &:hover .save
    visibility: visible
    opacity: 0.95

.save
  butt-on-states()

.message-meta
  .dropdown
    /* compensate for the icon being higher and not looking like it occupies the lower space */
    margin-bottom: -24px

  time
    color: color-light-fg-lesser
    font-size: 16px
    padding: 0
    margin-right: 8px

.message-overflow
  display: inline-block

  > .icon
    margin-left: 24px
    margin-bottom: 8px

  &:hover
    cursor: pointer

  &:disabled:hover
    cursor: default

  &:hover .icon,
  &:active .icon
    color: color-light-fg

  &:disabled:disabled .icon
    color: color-light-fg-disabled

.identicon
  width: 38px
  height: 38px
  border: 1px solid color-light-border
  border-radius: 2px
  margin: 1px 8px 1px 2px
  padding: 3px

  .block
    display: inline-block
    float: left
    width: 20%
    height: 20%

#message-input
  display: flex

  position: fixed
  bottom: 4px
  left: 0px
  right: 0px

  margin: auto
  padding: 0
  width: 1400px

  .progress
    position: absolute

.preview-container
  background: color-video-bg
  position: relative

  height: 150px
  width: 200px
  flex-shrink: 0

  video
    height: 100%
    width: 100%

  .switch-camera,
  .switch-camera:focus
    position: absolute
    display: block
    /* vertical differences here account for weirdness in this particular icon's spacing */
    padding: 6px 8px 2px
    bottom: 8px
    left: 8px

  &:hover .switch-camera
    visibility: visible
    opacity: 0.95

.switch-camera
  butt-on()
  opacity: 0
  visibility: hidden

  transition: visibility 0.4s, opacity 0.4s, background-color 0.4s
  transition-timing-function: cubic-bezier(.4, 0, .2, 1)

  &:hover
    background-color: color-light-button-pending
    cursor: pointer

  &:active
    background-color: color-light-button-active

.camera-disabled-message
  position: absolute
  left: 0
  top: 0
  right: 0
  bottom: 0
  padding: 16px
  color: color-video-fg

  display: flex
  flex-direction: column
  justify-content: center
  align-items: center
  text-align: center

.camera-disabled-icon
  margin-bottom: 8px
  font-size: 48px

.camera-disabled-text
  font-size: 20px

.camera-enabled .camera-disabled-message
  display: none

#message-form
  align-self: flex-end
  background-color: color-light-message-bg
  border-radius: 2px
  display: flex
  flex: 1
  margin: 0 8px
  overflow: hidden

#message
  background: color-light-message-bg
  border: none
  border-bottom: 1px solid color-light-border
  color: #212121
  font-family: 'Roboto', 'sans-serif'
  font-size: 16px
  flex: 1
  margin-bottom: 4px
  margin-left: 6px
  margin-top: 4px
  outline: none
  padding: 4px 2px
  overflow: hidden

  transition: border-color .3s
  transition-timing-function: cubic-bezier(.4, 0, .2, 1)

  :hover
    border-color: color-light-fg-lesser

  :active,
  :focus
    border-color: color-light-accent
    border-width: 2px
    padding: 4px 2px 3px 2px /* account for extra border size */

  .full:active,
  .full:focus
    border-color: color-light-error

  [readonly]
    border-color: color-light-accent-disabled
    color: color-light-fg-disabled

#char-counter
  color: rgba(0, 0, 0, 0.54)
  padding: 0px 8px
  margin: auto
  font-size: 12px
  overflow: hidden
  white-space: nowrap
  visibility: hidden
  opacity: 0

  transition: visiblity .3s, opacity .3s, color .3s
  transition-timing-function: cubic-bezier(.4, 0, .2, 1)

  .full
    color: #F44336

#message:active + #char-counter,
#message:focus + #char-counter
  visibility: visible
  opacity: 1

#send
  margin: 0 0 0 4px
  padding-left: 16px
  padding-right: 16px

  border: 0
  background-color: color-light-button-bg
  /* match the form's border radius on the outer corners */
  border-radius: 0 2px 2px 0

  butt-on-states()

.progress
  display: block
  width: 48px
  height: 48px
  border-radius: 50%
  margin: 8px
  pointer-events: none
  visibility: hidden
  opacity: 0

  transition: visibility .3s, opacity .3s
  transition-timing-function: cubic-bezier(.4,0,.2,1)

  &.visible
    visibility: visible
    opacity: 1

  .circle
    .mask, .fill
      width: 48px
      height: 48px
      position: absolute
      border-radius: 50%

      backface-visibility: hidden
      transition: transform .3s

    .mask
      clip: rect(0px, 48px, 48px, 24px)

      .fill
        clip: rect(0px, 24px, 48px, 0px)
        background-color: color-light-accent

  .inset
    width: 36px
    height: 36px
    position: absolute
    margin-left: 6px; /* (circle size - inset size) / 2 */
    margin-top: 6px
    border-radius: 50%
    background-color: color-light-message-bg
    display: flex
    justify-content: center
    align-items: center

  .text
    color: color-light-fg
    overflow: hidden

.dialog-scrim
  position: fixed
  left: 0
  right: 0
  top: 0
  bottom: 0
  z-index: 20
  background-color: color-light-dialog-scrim

  transition: opacity cubic-bezier(.4, 0, .2, 1) 300ms
  opacity: 1

  &.entering, &.leaving
    opacity: 0

.dialog-container
  position: fixed
  left: 0
  right: 0
  top: 0
  bottom: 0
  display: flex
  flex-direction: column
  justify-content: center
  align-items: center
  z-index: 21
  overflow: hidden

.dialog
  background-color: color-light-dialog-bg
  width: 672px
  height: auto
  max-height: 80vh
  overflow-y: auto
  padding: 24px
  transition: transform cubic-bezier(0, 0, .2, 1) 400ms
  transform: translateY(0)

  &.entering
    transform: translateY(100vh)

  &.will-leave
    transition: all cubic-bezier(.4, 0, 1, 1) 400ms

  &.leaving
    transform: translateY(-100vh)

  > h2:first-child
    margin-top: 0
    margin-bottom: 0
    margin-right: 8px
    display: inline-block

  > h2 + .secondary
    display: inline-block

  ul
    margin-left: 20px

  li
    padding-left: 8px
    margin-top: 8px
    margin-bottom: 8px

.secondary
  color: color-light-fg-lesser

.flex-grow
  align-items: flex-end
  display: flex
  flex-direction: row
  flex: 1

.shadow-1
  box-shadow:
    0 3px 1px -2px rgba(0, 0, 0, .14),
    0 2px 2px 0 rgba(0,0,0,.098),
    0 1px 5px 0 rgba(0,0,0,.084)

.shadow-2
  box-shadow:
    0 2px 4px -1px rgba(0,0,0,.14),
    0 4px 5px 0 rgba(0,0,0,.098),
    0 1px 10px 0 rgba(0,0,0,.084)

.shadow-5
  box-shadow:
    0 8px 10px -5px rgba(0,0,0,.14),
    0 16px 24px 2px rgba(0,0,0,.098),
    0 6px 30px 5px rgba(0,0,0,.084)

.dark
  @import 'dark.styl'

@media (max-width: 2000px)
  #message-list
    max-width: 892px

  #message-input
    max-width: 892px


@media (max-width: 1460px)
  #message-list
    width: auto

  #message-input
    width: auto

  .dialog
    width: 480px
    max-width: 90vw


@media (max-width: 1000px)
  #message-list
    min-width: 0px
    margin-bottom: 110px

  #message-list li
    font-size: 14px

  #message-list li .video-container
    height: 102px
    width: 136px

  .preview-container
    height: 102px
    width: 136px

  .camera-disabled-icon
    margin-bottom: 4px

  .camera-disabled-text
    font-size: 15px

  .message-meta time
    font-size: 12px

  .identicon
    height: 28px
    width: 28px

  #char-counter
    display: none

  #message
    margin-right: 2px


@keyframes filmstrip
  0%
    transform: translateY(0)
    animation-timing-function: steps(1)

  10%
    transform: translateY(-10%)
    animation-timing-function: steps(1)

  20%
    transform: translateY(-20%)
    animation-timing-function: steps(1)

  30%
    transform: translateY(-30%)
    animation-timing-function: steps(1)

  40%
    transform: translateY(-40%)
    animation-timing-function: steps(1)

  50%
    transform: translateY(-50%)
    animation-timing-function: steps(1)

  60%
    transform: translateY(-60%)
    animation-timing-function: steps(1)

  70%
    transform: translateY(-70%)
    animation-timing-function: steps(1)

  80%
    transform: translateY(-80%)
    animation-timing-function: steps(1)

  90%
    transform: translateY(-90%)
    animation-timing-function: steps(1)
